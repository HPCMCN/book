* #### 1. django2和3区别

  1. url
  2. 协程

  #### 2. django和flask区别

  django的映射关系是: url和视图的map关系

  flask的映射关系是: viewname和业务函数的map关系

  Django特点:

  * ORM开发快速, 可以节约成本. 同时会降低一定的查询效率
  * 并发量不是很高, 大概1w

  Flask:

  * 开发灵活, 三方拓展包也比较丰富

  #### 3. django查询优化

  1. 减少外键使用, 影响插入性能
  2. 使用缓存, 减少数据库的访问
  3. 尽量使用varchar, 而不是text
  4. 查询频繁字段, 创建索引
  5. queryset默认是一个缓存集, 可以重复调用, 被存储在内存的cache里面
  6. 如果一个页面需要连接数据库, 尽量一次查询出来
  7. 如果字段不需要那么多, 可以使用values
  8. 模板里面with标签可以缓存queryset
  9. 分布式操作

  #### 4. nginx和uWSGI的区别

  nginx: 

  * 接受客户端请求, 并分发动态请求给uWSGI, 静态请求自己直接获取并返回
  * 接受uWSGI响应转发给客户端

  uWSGI:

  * 接受nginx请求的数据, 并遵循WSGI协议, 调用Django的app服务, 并将用户信息传递给对应函数
  * 函数收到数据, 处理后内部调用uWSGI服务器对象, 并将响应头部信息设置完毕
  * 最终将处理后数据返回给uWSGI服务器
  * 最终由uWSGI服务器返回给nginx

  #### REST API

  1. api配置为专有域名, 或者在主域名的根资源下

  2. 版本控制需要放置在url路径中

  3. 每个url都是一种资源, 且是一种名词形式

  4. 需要通过http请求动词方式来区别资源操作的方式

  5. 资源信息较多需要分页访问

  6. 状态码: 

     10x表示资源还待传递

     20x表示服务器处理完成

     30x表示资源需要重新访问

     40x表示请求有问题

     50x表示服务器故障

  #### SCRF攻击

  * 由于浏览器每次请求都会携带对应的cookies信息请求网站
  * 用户信息没有请求, 去访问三方网站页面时, 受到三方页面误导, 点击对应表单
  * 对方将此次请求转接到主体网站, 造成数据在不知情状况下被篡改

  解决:

  * 开启跨域攻击中间件
  * 增加post表单的scrf_token字段
  * 增加验证码等

  #### 正/反代理

  正向代理: 从局域网出发, 访问互联网服务器. 此时服务器不知道访问者是谁

  反向代理: 从互联网出发, 访问局域网服务器

  

  #### MySQL

  事务: 原子性, 一致性, 隔离性, 永久性

  索引: 排序的结构, 协助快速查询的. 常见的b_tree在根节点保存了子节点的指针, 达到快速查找的效果

  引擎:

  * InnoDB: 支持事务, 多版本并发, 外键. 占用数据空间大, 读写效率查
  * MyISAM: 访问速度快. 占用空间大, 容易产生碎片空间
    * frm: 表结构存储
    * myd: 数据存储
    * myi: 索引存储
  * MEMORY: 采用hash索引, 内存存储, 利于数据的快速处理. 但是容易丢失数据![img](.image/04-django/2020081017332271-1711101896226.png)

  优化:

  * 引擎选择InnoDB
  * 分表分库(水平拆分), 分库读写分离(垂直拆分)
  * sql优化 
    * 加索引
    * 避免全表扫描, 一下判断将放弃使用索引, 进行全表扫描: null判断, !=, <>, or中有个没索引
    * update指定字段, 不要全量修改.
    * 先分页在join
  * 遵循三范式设计表结构: 列不可在分割, 有唯一表示, 引用主键
  * 使用缓存或者NoSQL存储
  * 增加硬件SSD
  * 架构分布式