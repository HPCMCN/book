# 1. MODE_ECB

![img](../image/01-%E5%AF%B9%E7%A7%B0%E6%80%A7%E5%8A%A0%E5%AF%86/0.7502136785492399.png) 
 ![img](../image/01-%E5%AF%B9%E7%A7%B0%E6%80%A7%E5%8A%A0%E5%AF%86/0.04586820136560599.png) 

步骤:

1. 将待加密数据按照8直接直接切分分组, 最后一组如果不是8字节, 则自动填充
2. 每组数据互不影响的加密
3. 按照顺序连接起来

特点:

1. 简单，有利于并行计算，误差不会被传送；
2. 不能隐藏明文的模式, 加密后的数据会出现重复的片段
3. 可能对明文进行主动攻击, 加密消息块相互独立成为被攻击的弱点

# 2. MODE_CBC

![img](../image/01-%E5%AF%B9%E7%A7%B0%E6%80%A7%E5%8A%A0%E5%AF%86/0.8141669492768562.png) 
 ![img](../image/01-%E5%AF%B9%E7%A7%B0%E6%80%A7%E5%8A%A0%E5%AF%86/0.1836923624485276.png) 
 步骤:

1. 将待加密数据按照8直接直接切分分组(n1, n2...), 最后一组如果不是8字节, 则自动填充
2. 将IV与n1异或计算后加密得到c1, 将c1与n2异或计算后加密得到c2......
3. 将c1, c2...按照顺序连接起来

特点:

1. 不容易主动攻击,安全性好于ECB,适合传输长度长的报文,是SSL、IPSec的标准。每个密文块依赖于所有的信息块, 明文消息中一个改变会影响所有密文块
2. 发送方和接收方都需要知道初始化向量 
3. 加密过程是串行的，无法被并行化(在解密时，从两个邻接的密文块中即可得到一个平文块。因此，解密过程可以被并行化)。

# 3. MODE_CFB

![img](../image/01-%E5%AF%B9%E7%A7%B0%E6%80%A7%E5%8A%A0%E5%AF%86/0.7052381432286141.png) 
 步骤:

1. 将待加密数据按照8直接直接切分分组(n1, n2...), 最后一组如果不是8字节, 则自动填充
2. 用key加密IV, 得到加密值C1
3. 然后取C1高位与n1异或运算得到密文e1, 然后让e1取代IV进行下一次运算
4. 将e1, e2....按照顺序组合起来

特点:

1. 和CBC模式类似

# 4. MODE_OFB

![img](../image/01-%E5%AF%B9%E7%A7%B0%E6%80%A7%E5%8A%A0%E5%AF%86/0.8673879864813367.png) 
 步骤:

1. 将待加密数据按照8直接直接切分分组(n1, n2...), 最后一组如果不是8字节, 则自动填充
2. 用key加密IV, 得到加密值C1
3. 然后用C1取代n2的IV进行下一轮的加密
4. 然后取C1高位与n1异或运算得到密文e1
5. 将e1, e2....按照顺序组合起来

特点:

1. 可以将块密码变成同步的流密码
2. 和CBC模式类似

# 5. MODE_CTR

![img](../image/01-%E5%AF%B9%E7%A7%B0%E6%80%A7%E5%8A%A0%E5%AF%86/0.2981521951435402.png) 
 步骤

1. 将待加密数据按照8直接直接切分分组(n1, n2...), 最后一组如果不是8字节, 则自动填充
2. 用key加密算子Counter得到e1, 用key加密算子Counter + 1得到e2....
3. 用e1与n1做异或运算, 得到密文c1,用e2与n2做异或运算, 得到密文c2...
4. 将c1, c2....按照顺序组合起来

# 6. MODE_OPENPGP

步骤: 
 类似CFB, 区别: 
 加密之后返回IV+C1用于异或运算, 核心源码如下:

 

```
    def encrypt(self, plaintext):
        res = self._cipher.encrypt(plaintext)
        if not self._done_first_block:
            res = self._encrypted_IV + res
            self._done_first_block = True
        return res
```

特点: 
 类似CFB

# 7. MODE_EAX

![img](../image/01-%E5%AF%B9%E7%A7%B0%E6%80%A7%E5%8A%A0%E5%AF%86/0.27651223687940285.png)