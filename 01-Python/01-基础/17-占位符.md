# 1. 占位符

为真实数据提供占位服务.

## 1.1 前缀

| 序号 | 前缀符号            | 作用                                                       | 示例 |
| ---- | ------------------- | ---------------------------------------------------------- | ---- |
| 1    | `u`/`U`             | 表示后面字符为Unicode类型, `u`不区分大小写性质相同         |      |
| 2    | `b`/`B`             | 表示后面字符为byte类型, `b`不区分大小写性质相同            |      |
| 3    | `r`/`R`             | 表示后面字符中转义字符无效, `r`不区分大小写性质相同        |      |
| 4    | `f`/`F`             | 表示后面字符中存在{xx}类型的, 将会按照`format`格式进行转义 |      |
| 5    | `fr`/`rf`/`br`/`rb` | 可以组合使用, 但是`ur`/`ru`在Python3中已被弃用             |      |

## 1.2 转义字符

| 序号 | 转义符号     | 作用                               | 示例 |
| ---- | ------------ | ---------------------------------- | ---- |
| 1    | `\`          | 1. 转义字符<br>2. 强制换行符       |      |
| 2    | `\a`         | ASCII 响铃                         |      |
| 3    | `\b`         | ASCII 退格 (BS)                    |      |
| 4    | `\f`         | ASCII 进纸/换页 (FF)               |      |
| 5    | `\n`         | ASCII 换行 (LF)                    |      |
| 6    | `\r`         | ASCII 消除本行前部分内容 (CR)      |      |
| 7    | `\t`         | ASCII 水平制表 (TAB)               |      |
| 8    | `\v`         | ASCII 垂直制表 (VT)                |      |
| 9    | `\ooo`       | 八进制数 ooo 码位的字符 (1,3)      |      |
| 10   | `\xhh`       | 十六进制数 hh 码位的字符 (2,3)     |      |
| 11   | `\N{name}`   | Unicode 数据库中名称为 name 的字符 |      |
| 12   | `\uxxxx`     | 16位十六进制数 xxxx 码位的字符     |      |
| 13   | `\Uxxxxxxxx` | 32位16进制数 xxxxxxxx 码位的字符   |      |

# 2. 字符串格式化

## 2.1 %

格式如下:

```python
"%+[(映射键)+转换镖旗+最小宽度+精度+长度修饰]+占位符类型" % (真实数据)
```

* %: 必填, 标记转换符开始,  标记: 1
* 映射键: 可选, 加圆括号的字符序列组成, 用于选择字典中的数据  标记: 2
* 转换旗标: 可选, 影响某些转换的格式  标记: 3
* 最小宽度: 可选, 影响输出的总长度  标记: 4
* 精度: 可选, 需要在前面加`.`表示精度读取开始, 控制小数点位数  标记: 5
* 长度修饰符: 可选, `h`, `l`, `L`, 在Python中这个字段无用, 会被忽略  标记: 6
* 占位符类型: 必填, 表示占位符输出的格式类型   标记: 7

转换旗标

| 符号   | 作用                                       |
| ------ | ------------------------------------------ |
| `0`    | 使用`0`填充                                |
| `-`    | 左对齐                                     |
| `+`    | 右对齐, 如果是数字类型为正值将显式出现正号 |
| `空格` | 空格填充, 数字类型正数补空格, 负数显示`-`  |
| `#`    | 格式化占位符, 可以与其他旗标符号连用       |

占位符

| 符号        | 作用                                                         |
| ----------- | ------------------------------------------------------------ |
| `d`/`u`/`i` | 有符号十进制整数                                             |
| `x`/`X`     | 有符号十六进制数（小写/大写）                                |
| `f`/`F`     | 浮点十进制格式                                               |
| `e`/`E`     | 浮点指数格式（小写/大写）                                    |
| `g`/`G`     | 浮点格式。 如果指数小于 -4 或不小于精度则使用（小写/大写）指数格式，否则使用十进制格式。 |
| `c`         | 单个字符（接受整数或单个字符的字符串）。                     |
| `r`         | 字符串（使用 `repr()` 转换任何 Python 对象）。               |
| `s`         | 字符串（使用 `str()` 转换任何 Python 对象）。                |
| `a`         | 字符串（使用 `ascii()` 转换任何 Python 对象）。              |
| `%%`        | 取消占位符, 显示`%`                                          |

示例

* 1 + 7

  ```python
  >>> a = (1, 2, 3)
  >>> print("%d--%s--%f" % a)
  1--2--3.000000
  ```

* 1 + 2 + 7

  ```python
  >>> a = {"a":1, "b": 2, "c": 3}
  >>> print("%(a)d--%(b)s--%(c)f" % a)
  1--2--3.000000
  ```

* 1 + 2 + 3 + 4 + 5 + 7

  ```python
  >>> a = 5.55
  >>> print("%(a)#016.5f" % {"a": a})
  0000000005.55000
  # 6个类型拆开分别为  %   (a)   0    16   .5  f
  ```

## 2.2 format

在Python3.8以后, 可以简写为`f`

格式如下

```python
{[映射键 + 旗标符号 + ":" + 填充符号 + 对齐符号 + 数学符号 + "#进制转换" + 宽度 + 千位分隔符 + ".小数点精度" + "占位符类型"]}
```

映射键

| 符号            | 说明                                         |
| --------------- | -------------------------------------------- |
| `{}`            | 直接取值, 是按照传入参数索引取值             |
| `{n}`           | 同上, 不过可以参数重复利用                   |
| `{somename}`    | 关键字取值, 接受参数为字典类型               |
| `{list[index]}` | 利用列表取值                                 |
| `{object.attr}` | 对象取值, 接受参数为对象, 获取对象的属性取值 |

旗标符号

| 符号 | 说明          |
| ---- | ------------- |
| `!r` | 调用repr方法  |
| `!s` | 调用str方法   |
| `!a` | 调用ascii方法 |

填充符号

* 后面参数均为站位替换类型, 需要以`":"`开头

| 符号 | 说明                                                         |
| ---- | ------------------------------------------------------------ |
| `<`  | 强制控制左对齐, 要想起作用, 需要修改宽度, 下同               |
| `>`  | 强制控制右对齐                                               |
| `^`  | 强制控制居中对齐                                             |
| `=`  | 强制控制对齐的起始位置要起始于`+`, `-`之后, 仅适用于数字类型 |

数学符号控制

| 符号   | 说明                                         |
| ------ | -------------------------------------------- |
| `+`    | 显式让数字类型出现`+`或者`-`号, 适用于正负数 |
| `-`    | 显式让数字类型出现`-`号, 适用于负数          |
| `空格` | 显式让数字类型负数出现`-`号, 正数前补空格    |

进制转换

* 参见`%`

宽度

* 参见`%`

千位分隔符

* 使用于数字类型

| 符号 | 说明                                                         |
| ---- | ------------------------------------------------------------ |
| `_`  | 千位以`_`分隔开来, 对于整数表示类型 'b', 'o', 'x' 和 'X'，将为每 4 个数位插入一个下划线。 |
| `,`  | 千位以`,`分隔开来                                            |

小数点精度

* 使用于数字类型
* 必须以`.`开始, 后跟小数点保留位数

数据输出类型

| 符号    | 说明                                                         |
| ------- | ------------------------------------------------------------ |
| `s`     | 字符串类型                                                   |
| `b`     | 二进制格式。 输出以 2 为基数的数字。                         |
| `c`     | 字符。在打印之前将整数转换为相应的unicode字符。              |
| `d`     | 十进制整数。 输出以 10 为基数的数字。                        |
| `o`     | 八进制格式。 输出以 8 为基数的数字。                         |
| `x`/`X` | 有符号十六进制数（小写/大写）                                |
| `f`/`F` | 浮点十进制格式                                               |
| `e`/`E` | 浮点指数格式（小写/大写）                                    |
| `g`/`G` | 浮点格式。 如果指数小于 -4 或不小于精度则使用（小写/大写）指数格式，否则使用十进制格式。 |
| `n`     | 数字。 这与 `g` 相似，不同之处在于它会使用当前区域设置来插入适当的数字分隔字符。 |
| `%`     | 百分比。 将数字乘以 100 并显示为定点 `f`格式，后面带一个百分号。 |

示例

* 取值

  ```python
  >>> a = 123
  >>> b = "123"
  >>> c = {"a": a, "b": b}
  >>> "{}, {}".format(a, b)
  '123, 123'
  >>> "{0}, {0}".format(a, b)
  '123, 123'
  >>> "{0}, {1}".format(a, b)
  '123, 123'
  >>> "{a}, {b}".format(a=a, b=b)
  '123, 123'
  >>> "{a}, {b}".format(**c)
  '123, 123'
  >>> from collections import namedtuple
  >>> D = namedtuple("d", "a b")
  >>> d = D(a, b)
  >>> d
  d(a=123, b='123')
  >>> "{0.a}, {0.b}".format(d)
  '123, 123'
  ```

* 符号填充

  ```python
  >>> a = "abc"
  >>> b = 123
  >>> "{0!s:*<10s}".format(a)
  'abc*******'
  >>> "{0!s:*<+10s}".format(b)  # 注意!r !s !a不能和数字类型数据混用
  Traceback (most recent call last):
    File "<stdin>", line 1, in <module>
  ValueError: Sign not allowed in string format specifier
  >>> "{0:<+020.5f}".format(b)
  '+0000000000123.00000'
  >>> "{0:<+020.5f}".format(b)
  '+123.000000000000000'
  ```

* [混用详解](https://docs.python.org/zh-cn/3.7/library/string.html#format-examples)

  ```python
  >>> from collections import namedtuple
  >>> D = namedtuple("d", "a b")
  d = D(123456789, "abc")
  >>> "{a.a:>+020,.5f}".format(**{"a": d})
  '+123,456,789.0000000'
  >>> "{a.a:1>+030,.5f}".format(**{"a": d})
  '111111111111+123,456,789.00000'
  >>> "{a.a:>+030,.5f}".format(**{"a": d})
  '000000000000+123,456,789.00000'
  >>> "{a.a:>+030,.3f}".format(**{"a": d})
  '00000000000000+123,456,789.000'
  >>> "{a.a:>+30,.3f}".format(**{"a": d})
  ' +123,456,789.000'
  >>> "{a.a:+030,.3f}".format(**{"a": d})
  '+0,000,000,000,123,456,789.000'
  
  # #x使用
  >>> "int: {0:d};  hex: {0:x};  oct: {0:o};  bin: {0:b}".format(42)
  'int: 42;  hex: 2a;  oct: 52;  bin: 101010'
  >>> # with 0x, 0o, or 0b as prefix:
  >>> "int: {0:d};  hex: {0:#x};  oct: {0:#o};  bin: {0:#b}".format(42)
  'int: 42;  hex: 0x2a;  oct: 0o52;  bin: 0b101010'
  ```

  